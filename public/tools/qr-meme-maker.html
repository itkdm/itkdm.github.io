<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨ - ä¸€é”®ç”Ÿæˆé—®å·æ˜Ÿ / è…¾è®¯é—®å·æµ·æŠ¥</title>
    <meta name="description" content="å…è´¹åœ¨çº¿é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨ï¼šæ”¯æŒé—®å·æ˜Ÿã€è…¾è®¯é—®å·ç­‰å¹³å°ï¼Œä¸Šä¼ äºŒç»´ç å³å¯ä¸€é”®åˆæˆé«˜æ¸…æ¢—å›¾æµ·æŠ¥ï¼Œé€‚åˆå‘æœ‹å‹åœˆã€å¾®ä¿¡ç¾¤ã€ç­çº§ç¾¤åšé—®å·é‚€è¯·ã€‚">
    <meta name="keywords" content="é—®å·äºŒç»´ç ,é—®å·æµ·æŠ¥,é—®å·æ˜ŸäºŒç»´ç ,è…¾è®¯é—®å·äºŒç»´ç ,äºŒç»´ç æ¢—å›¾,é—®å·é‚€è¯·å›¾ç‰‡,é—®å·æ¨å¹¿,äºŒç»´ç åˆæˆ,å›¾ç‰‡åˆæˆ">
    <link rel="canonical" href="https://itkdm.com/tools/qr-meme-maker.html">
    <meta property="og:title" content="é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨ - ä¸€é”®ç”Ÿæˆé—®å·æ˜Ÿ / è…¾è®¯é—®å·æµ·æŠ¥">
    <meta property="og:description" content="ä¸Šä¼ é—®å·äºŒç»´ç ï¼Œé€‰æ‹©æ¢—å›¾æ¨¡æ¿ï¼Œä¸€é”®ç”Ÿæˆé€‚åˆè½¬å‘åˆ°æœ‹å‹åœˆå’Œå¾®ä¿¡ç¾¤çš„é—®å·é‚€è¯·æµ·æŠ¥ï¼Œæ”¯æŒé—®å·æ˜Ÿã€è…¾è®¯é—®å·ç­‰å¹³å°ã€‚">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://itkdm.com/tools/qr-meme-maker.html">
    <meta property="og:image" content="https://itkdm.com/tools/qr-meme-templates/001.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="author" content="itkdm.com">
    <meta name="robots" content="index, follow">
    <meta name="language" content="zh-CN">
    <meta name="revisit-after" content="7 days">
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://itkdm.com">
    <link rel="dns-prefetch" href="https://itkdm.com">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨",
      "description": "å…è´¹åœ¨çº¿é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨ï¼šæ”¯æŒé—®å·æ˜Ÿã€è…¾è®¯é—®å·ç­‰å¹³å°ï¼Œä¸Šä¼ äºŒç»´ç å³å¯ä¸€é”®åˆæˆé«˜æ¸…æ¢—å›¾æµ·æŠ¥ï¼Œé€‚åˆå‘æœ‹å‹åœˆã€å¾®ä¿¡ç¾¤ã€ç­çº§ç¾¤åšé—®å·é‚€è¯·ã€‚",
      "url": "https://itkdm.com/tools/qr-meme-maker.html",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Web Browser",
      "browserRequirements": "Requires JavaScript. Requires HTML5.",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "CNY"
      },
      "featureList": [
        "æ”¯æŒ34ç§æ¢—å›¾æ¨¡æ¿",
        "æœ¬åœ°å¤„ç†ï¼Œä¿æŠ¤éšç§",
        "æ”¯æŒPNG/JPGæ ¼å¼",
        "ä¸€é”®ä¸‹è½½é«˜æ¸…å›¾ç‰‡",
        "æ”¯æŒäºŒç»´ç ä½ç½®è°ƒæ•´å’Œæ—‹è½¬",
        "æ”¯æŒé—®å·æ˜Ÿã€è…¾è®¯é—®å·ç­‰å¹³å°"
      ],
      "screenshot": "https://itkdm.com/tools/qr-meme-templates/001.png",
      "softwareVersion": "1.0",
      "releaseNotes": "æ”¯æŒ34ç§æ¨¡æ¿ï¼Œæœ¬åœ°å¤„ç†ï¼Œæ— éœ€ä¸Šä¼ æœåŠ¡å™¨"
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "æ”¯æŒå“ªäº›é—®å·å¹³å°ï¼Ÿ",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "æ”¯æŒæ‰€æœ‰ç”ŸæˆäºŒç»´ç çš„é—®å·å¹³å°ï¼ŒåŒ…æ‹¬é—®å·æ˜Ÿã€è…¾è®¯é—®å·ã€Google Formsã€Microsoft Formsã€Typeform ç­‰ã€‚åªè¦ä½ èƒ½å¯¼å‡ºäºŒç»´ç å›¾ç‰‡ï¼Œå°±å¯ä»¥ä½¿ç”¨æœ¬å·¥å…·ã€‚"
          }
        },
        {
          "@type": "Question",
          "name": "æ”¯æŒå“ªäº›å›¾ç‰‡æ ¼å¼ï¼Ÿ",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "æ”¯æŒå¸¸è§çš„å›¾ç‰‡æ ¼å¼ï¼ŒåŒ…æ‹¬ PNGã€JPGã€JPEGã€WebP ç­‰ã€‚å»ºè®®ä½¿ç”¨ PNG æ ¼å¼ä»¥è·å¾—æœ€ä½³æ•ˆæœã€‚"
          }
        },
        {
          "@type": "Question",
          "name": "å›¾ç‰‡ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨å—ï¼Ÿ",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "ä¸ä¼šã€‚æ‰€æœ‰å›¾ç‰‡å¤„ç†éƒ½åœ¨ä½ çš„æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨ï¼Œå®Œå…¨ä¿æŠ¤ä½ çš„éšç§å®‰å…¨ã€‚"
          }
        },
        {
          "@type": "Question",
          "name": "å¦‚ä½•è°ƒæ•´äºŒç»´ç çš„ä½ç½®å’Œå¤§å°ï¼Ÿ",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "åœ¨é¢„è§ˆåŒºåŸŸå¯ä»¥ç›´æ¥æ‹–åŠ¨äºŒç»´ç è°ƒæ•´ä½ç½®ï¼Œä½¿ç”¨\"äºŒç»´ç å¤§å°\"æ»‘å—è°ƒæ•´å°ºå¯¸ï¼Œä½¿ç”¨\"æ—‹è½¬è§’åº¦\"æ»‘å—è°ƒæ•´æ—‹è½¬ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡»\"é€‚é…æ¨èåŒºåŸŸ\"æŒ‰é’®è‡ªåŠ¨è°ƒæ•´åˆ°æœ€ä½³ä½ç½®ã€‚"
          }
        },
        {
          "@type": "Question",
          "name": "ä¸‹è½½çš„å›¾ç‰‡è´¨é‡å¦‚ä½•ï¼Ÿ",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "ä¸‹è½½çš„å›¾ç‰‡ä¸º PNG æ ¼å¼ï¼Œä¿æŒåŸå§‹æ¨¡æ¿çš„é«˜æ¸…è´¨é‡ã€‚å»ºè®®äºŒç»´ç å°ºå¯¸è®¾ç½®ä¸º 600x600 åƒç´ æˆ–æ›´å¤§ï¼Œä»¥ç¡®ä¿æ‰«ææ•ˆæœã€‚"
          }
        },
        {
          "@type": "Question",
          "name": "å·¥å…·æ˜¯å…è´¹çš„å—ï¼Ÿ",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "æ˜¯çš„ï¼Œå®Œå…¨å…è´¹ä½¿ç”¨ï¼Œæ— éœ€æ³¨å†Œï¼Œæ— éœ€ä»˜è´¹ï¼Œæ²¡æœ‰ä»»ä½•é™åˆ¶ã€‚"
          }
        },
        {
          "@type": "Question",
          "name": "åœ¨æ‰‹æœºä¸Šå¯ä»¥ä½¿ç”¨å—ï¼Ÿ",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "å¯ä»¥ã€‚æœ¬å·¥å…·æ”¯æŒç§»åŠ¨ç«¯æµè§ˆå™¨ï¼Œåœ¨æ‰‹æœºã€å¹³æ¿ç­‰è®¾å¤‡ä¸Šéƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚"
          }
        }
      ]
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "å¦‚ä½•ä½¿ç”¨é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨",
      "description": "è¯¦ç»†æ­¥éª¤è¯´æ˜å¦‚ä½•ä½¿ç”¨é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨å°†é—®å·äºŒç»´ç åˆæˆåˆ°æ¢—å›¾æ¨¡æ¿ä¸­",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "é€‰æ‹©æ¨¡æ¿",
          "text": "åœ¨æ¨¡æ¿å¹¿åœºä¸­æµè§ˆå¹¶é€‰æ‹©ä½ å–œæ¬¢çš„æ¢—å›¾æ¨¡æ¿ï¼ˆå…±23ç§å¯é€‰ï¼ŒåŒ…æ‹¬åŠå…¬ã€åŠ¨æ¼«ã€äººç‰©ç­‰ä¸åŒé£æ ¼ï¼‰",
          "image": "https://itkdm.com/tools/qr-meme-templates/001.png"
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "ä¸Šä¼ äºŒç»´ç ",
          "text": "ç‚¹å‡»å·¦ä¾§\"é€‰æ‹©å›¾ç‰‡\"æŒ‰é’®ï¼Œä»ä½ çš„è®¾å¤‡ä¸­é€‰æ‹©é—®å·äºŒç»´ç å›¾ç‰‡ï¼ˆæ”¯æŒ PNGã€JPGã€JPEGã€WebP ç­‰æ ¼å¼ï¼‰"
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "è£å‰ªäºŒç»´ç ",
          "text": "ä¸Šä¼ åä¼šå¼¹å‡ºè£å‰ªçª—å£ï¼Œä½ å¯ä»¥æ‹–åŠ¨å›¾ç‰‡è°ƒæ•´ä½ç½®ï¼Œä½¿ç”¨æ»‘å—æ”¾å¤§ç¼©å°ï¼Œç¡®ä¿äºŒç»´ç å®Œæ•´æ˜¾ç¤ºåœ¨è£å‰ªæ¡†å†…"
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "è°ƒæ•´ä½ç½®å’Œå¤§å°",
          "text": "åœ¨å³ä¾§é¢„è§ˆåŒºåŸŸï¼Œä½ å¯ä»¥ç›´æ¥æ‹–åŠ¨äºŒç»´ç è°ƒæ•´ä½ç½®ï¼Œä½¿ç”¨\"äºŒç»´ç å¤§å°\"æ»‘å—è°ƒæ•´å°ºå¯¸ï¼ˆ0.6å€åˆ°1.6å€ï¼‰ï¼Œä½¿ç”¨\"æ—‹è½¬è§’åº¦\"æ»‘å—è°ƒæ•´æ—‹è½¬ï¼ˆ-180åº¦åˆ°180åº¦ï¼‰ï¼Œæˆ–ç‚¹å‡»\"é€‚é…æ¨èåŒºåŸŸ\"è‡ªåŠ¨è°ƒæ•´åˆ°æœ€ä½³ä½ç½®"
        },
        {
          "@type": "HowToStep",
          "position": 5,
          "name": "ä¸‹è½½å›¾ç‰‡",
          "text": "è°ƒæ•´æ»¡æ„åï¼Œç‚¹å‡»\"ä¸‹è½½å›¾ç‰‡\"æŒ‰é’®ï¼Œä¿å­˜åˆæˆåçš„é«˜æ¸… PNG å›¾ç‰‡åˆ°ä½ çš„è®¾å¤‡"
        }
      ],
      "totalTime": "PT2M",
      "tool": [
        {
          "@type": "HowToTool",
          "name": "é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨"
        }
      ],
      "supply": [
        {
          "@type": "HowToSupply",
          "name": "é—®å·äºŒç»´ç å›¾ç‰‡"
        }
      ]
    }
    </script>

    <link rel="stylesheet" href="/theme.css">
    <style>
        .tool-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1rem 3rem;
        }
        .tool-header {
            margin-bottom: 2rem;
        }
        .tool-header h1 {
            margin: 0 0 0.55rem 0;
            font-size: clamp(1.8rem, 2.4vw, 2.2rem);
            letter-spacing: -0.02em;
        }
        .tool-header p {
            color: var(--text-muted);
            margin: 0;
            max-width: 680px;
        }
        .tool-main {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        .top-section {
            display: grid;
            grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
            gap: 1.5rem;
            align-items: stretch;
        }
        @media (max-width: 900px) {
            .top-section {
                grid-template-columns: 1fr;
            }
        }
        .top-card {
            background: var(--bg-elev);
            border-radius: 14px;
            border: 1px solid var(--border);
            padding: 1.4rem 1.6rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            min-height: 420px;
        }
        .top-card h2 {
            margin: 0;
            font-size: 1rem;
            letter-spacing: 0.04em;
            text-transform: uppercase;
            color: var(--text-muted);
        }
        .panel {
            background: var(--bg-elev);
            border-radius: 14px;
            border: 1px solid var(--border);
            padding: 1.4rem 1.6rem;
        }
        .panel h2 {
            margin: 0 0 1rem;
            font-size: 1.05rem;
            letter-spacing: 0.04em;
            text-transform: uppercase;
            color: var(--text-muted);
        }
        .field {
            margin-bottom: 1rem;
        }
        .field label {
            display: block;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.4rem;
            color: var(--text);
        }
        .field small {
            display: block;
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.15rem;
        }
        .input-file {
            display: inline-flex;
            align-items: center;
            gap: 0.6rem;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }
        .input-file input[type="file"] {
            display: none;
        }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.35rem;
            padding: 0.55rem 1rem;
            border-radius: 999px;
            border: 1px solid var(--border);
            background: color-mix(in srgb, var(--bg-elev) 80%, transparent);
            color: var(--text);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
        }
        .btn:hover,
        .btn:focus,
        .btn:active {
            background: color-mix(in srgb, var(--bg-elev) 80%, transparent);
            border-color: var(--border);
            color: var(--accent);
            box-shadow: none;
            transform: none;
        }
        .btn-primary {
            background: var(--accent);
            border-color: var(--accent);
            color: #fff;
        }
        .btn-primary:hover,
        .btn-primary:focus,
        .btn-primary:active {
            background: var(--accent);
            border-color: var(--accent);
            color: #fff;
        }
        .btn-secondary {
            background: transparent;
        }
        .btn-secondary:hover,
        .btn-secondary:focus,
        .btn-secondary:active {
            background: transparent;
            color: var(--accent);
        }
        .btn[disabled] {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .file-label {
            padding: 0.4rem 0.9rem;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: #fff;
        }
        .file-name {
            font-size: 0.8rem;
            color: var(--text-muted);
            max-width: 320px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding: 0.25rem 0.5rem;
            border-radius: 8px;
            background: color-mix(in srgb, var(--bg-elev) 88%, transparent);
        }
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1rem;
        }
        .template-card {
            border-radius: 10px;
            border: 1px solid var(--border);
            background: color-mix(in srgb, var(--bg-elev) 90%, transparent);
            padding: 0.5rem;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .template-card.selected {
            border-color: var(--accent);
            box-shadow: 0 0 0 1px color-mix(in srgb, var(--accent) 80%, transparent);
        }
        .template-thumb {
            width: 100%;
            height: auto;
            border-radius: 8px;
            object-fit: contain;
            background: #f2f4f8;
            display: block;
        }
        .template-info {
            display: none;
        }
        .template-title {
            font-weight: 600;
        }
        .template-tag {
            font-size: 0.7rem;
            padding: 0.05rem 0.35rem;
            border-radius: 999px;
            background: color-mix(in srgb, var(--accent) 12%, transparent);
            color: var(--accent);
        }
        .template-desc {
            display: none;
        }
        .template-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.35rem;
        }
        .template-chip {
            font-size: 0.68rem;
            padding: 0.1rem 0.45rem;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.06);
            color: var(--text);
        }
        .templates-toolbar {
            display: grid;
            grid-template-columns: minmax(0, 1fr);
            gap: 0.75rem;
            margin-bottom: 0.9rem;
        }
        .search-box {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            border-radius: 999px;
            border: 1px solid var(--border);
            padding: 0.3rem 0.9rem;
            background: color-mix(in srgb, var(--bg-elev) 92%, transparent);
        }
        .search-box input {
            border: none;
            outline: none;
            background: transparent;
            width: 100%;
            font-size: 0.9rem;
            color: var(--text);
        }
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 0.4rem 0.6rem;
        }
        .filter-row,
        .template-count,
        .template-hint,
        .tips {
            display: none;
        }
        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
        }
        .filter-chip {
            border-radius: 999px;
            padding: 0.2rem 0.7rem;
            border: 1px solid var(--border);
            background: #fff;
            font-size: 0.75rem;
            cursor: pointer;
        }
        .filter-chip.active {
            background: var(--accent);
            color: #fff;
            border-color: var(--accent);
        }
        .template-count {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-left: auto;
        }
        .templates-empty {
            padding: 1rem;
            border-radius: 12px;
            border: 1px dashed var(--border);
            color: var(--text-muted);
            text-align: center;
            font-size: 0.85rem;
        }
        .preview-wrapper {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .preview-box {
            border-radius: 12px;
            border: 1px solid var(--border);
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9));
            padding: 0.75rem;
            min-height: 260px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .preview-box-inner {
            max-width: 100%;
            position: relative;
        }
        .preview-placeholder {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.85rem;
        }
        .preview-image {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.12);
            display: block;
        }
        .tips {
            font-size: 0.8rem;
            color: var(--text-muted);
            line-height: 1.6;
        }
        .tips ul {
            padding-left: 1.1rem;
            margin: 0.4rem 0 0;
        }
        .tips li {
            margin-bottom: 0.2rem;
        }
        .template-hint {
            margin-top: 0.5rem;
            padding: 0.6rem 0.75rem;
            border-radius: 10px;
            border: 1px dashed var(--border);
            background: color-mix(in srgb, var(--bg-elev) 92%, transparent);
            font-size: 0.85rem;
            line-height: 1.5;
        }
        .template-hint strong {
            color: var(--accent);
        }
        .template-preview {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: #fff;
            padding: 0.75rem;
        }
        .template-preview img {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            display: block;
        }
        .templates-search {
            display: flex;
            justify-content: center;
            margin-bottom: 1rem;
        }
        .templates-search .search-box {
            width: min(420px, 90%);
        }
        .editor-canvas {
            width: 100%;
            height: auto;
            border-radius: 10px;
            background: #fff;
            touch-action: none;
            display: block;
        }
        .editor-overlay {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .editor-controls {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .range-control {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        .range-control label {
            font-size: 0.85rem;
            font-weight: 600;
            min-width: 72px;
        }
        .range-control input[type="range"] {
            flex: 1;
        }
        .editor-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        .editor-hint {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        .modal {
            position: fixed;
            inset: 0;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(15, 23, 42, 0.6);
            z-index: 20;
            padding: 1.5rem;
        }
        .modal.is-open {
            display: flex;
        }
        .modal-card {
            width: min(520px, 100%);
            border-radius: 14px;
            background: var(--bg-elev);
            border: 1px solid var(--border);
            box-shadow: 0 20px 40px rgba(0,0,0,0.18);
            padding: 1.25rem 1.5rem 1.5rem;
        }
        .modal-card h3 {
            margin: 0 0 0.8rem;
            font-size: 1.05rem;
        }
        .crop-stage {
            display: flex;
            flex-direction: column;
            gap: 0.65rem;
            align-items: center;
        }
        .crop-canvas {
            width: min(440px, 100%);
            border-radius: 12px;
            background: #0f172a;
            touch-action: none;
        }
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.6rem;
            margin-top: 1rem;
        }
        .crop-meta {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        .crop-meta strong {
            color: var(--accent);
        }
        .intro-section {
            background: var(--bg-elev);
            border-radius: 14px;
            border: 1px solid var(--border);
            padding: 1.6rem 1.8rem;
            margin-bottom: 2rem;
        }
        .intro-section h2 {
            margin: 0 0 1rem;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text);
        }
        .intro-section p {
            margin: 0 0 1rem;
            line-height: 1.7;
            color: var(--text);
        }
        .intro-section ol,
        .intro-section ul {
            margin: 0.5rem 0 1rem;
            padding-left: 1.5rem;
            line-height: 1.8;
            color: var(--text);
        }
        .intro-section li {
            margin-bottom: 0.5rem;
        }
        .intro-section strong {
            color: var(--accent);
        }
        .faq-section {
            background: var(--bg-elev);
            border-radius: 14px;
            border: 1px solid var(--border);
            padding: 1.6rem 1.8rem;
            margin-top: 2rem;
        }
        .faq-section h2 {
            margin: 0 0 1.2rem;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text);
        }
        .faq-item {
            margin-bottom: 1.2rem;
        }
        .faq-item:last-child {
            margin-bottom: 0;
        }
        .faq-question {
            font-weight: 600;
            font-size: 1rem;
            color: var(--text);
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }
        .faq-answer {
            color: var(--text);
            line-height: 1.7;
            margin: 0;
            padding-left: 0.5rem;
        }
        .related-tools-section {
            background: var(--bg-elev);
            border-radius: 14px;
            border: 1px solid var(--border);
            padding: 1.6rem 1.8rem;
            margin-top: 2rem;
        }
        .related-tools-section h2 {
            margin: 0 0 1rem;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text);
        }
        .related-tools-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }
        .related-tools-list li {
            margin: 0;
        }
        .related-tools-list a {
            color: var(--accent);
            text-decoration: none;
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            transition: opacity 0.2s;
        }
        .related-tools-list a:hover {
            opacity: 0.8;
            text-decoration: underline;
        }
        .related-tools-list a::before {
            content: "â†’";
            color: var(--text-muted);
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <header class="tool-header">
            <h1>é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨</h1>
            <p>é€‰æ‹©æ¨¡æ¿ â†’ ä¸Šä¼ äºŒç»´ç  â†’ è‡ªåŠ¨ç”Ÿæˆ</p>
        </header>

        <section class="intro-section">
            <h2>åŠŸèƒ½ä»‹ç»</h2>
            <p>é—®å·äºŒç»´ç æ¢—å›¾ç”Ÿæˆå™¨æ˜¯ä¸€æ¬¾<strong>å…è´¹åœ¨çº¿å·¥å…·</strong>ï¼Œå¸®åŠ©ä½ å°†é—®å·äºŒç»´ç åˆæˆåˆ°æœ‰è¶£çš„æ¢—å›¾æ¨¡æ¿ä¸­ï¼Œç”Ÿæˆé€‚åˆè½¬å‘åˆ°æœ‹å‹åœˆã€å¾®ä¿¡ç¾¤ã€ç­çº§ç¾¤çš„é—®å·é‚€è¯·æµ·æŠ¥ã€‚æ”¯æŒ<strong>é—®å·æ˜Ÿã€è…¾è®¯é—®å·ã€Google Forms</strong>ç­‰æ‰€æœ‰ç”ŸæˆäºŒç»´ç çš„é—®å·å¹³å°ã€‚</p>
            
            <h2>ä½¿ç”¨æ­¥éª¤</h2>
            <ol>
                <li><strong>é€‰æ‹©æ¨¡æ¿</strong>ï¼šåœ¨ä¸‹æ–¹æ¨¡æ¿å¹¿åœºä¸­æµè§ˆå¹¶é€‰æ‹©ä½ å–œæ¬¢çš„æ¢—å›¾æ¨¡æ¿ï¼ˆå…±34ç§å¯é€‰ï¼ŒåŒ…æ‹¬åŠå…¬ã€åŠ¨æ¼«ã€äººç‰©ç­‰ä¸åŒé£æ ¼ï¼‰</li>
                <li><strong>ä¸Šä¼ äºŒç»´ç </strong>ï¼šç‚¹å‡»å·¦ä¾§"é€‰æ‹©å›¾ç‰‡"æŒ‰é’®ï¼Œä»ä½ çš„è®¾å¤‡ä¸­é€‰æ‹©é—®å·äºŒç»´ç å›¾ç‰‡ï¼ˆæ”¯æŒ PNGã€JPGã€JPEGã€WebP ç­‰æ ¼å¼ï¼‰</li>
                <li><strong>è£å‰ªäºŒç»´ç </strong>ï¼ˆå¯é€‰ï¼‰ï¼šä¸Šä¼ åä¼šå¼¹å‡ºè£å‰ªçª—å£ï¼Œä½ å¯ä»¥æ‹–åŠ¨å›¾ç‰‡è°ƒæ•´ä½ç½®ï¼Œä½¿ç”¨æ»‘å—æ”¾å¤§ç¼©å°ï¼Œç¡®ä¿äºŒç»´ç å®Œæ•´æ˜¾ç¤ºåœ¨è£å‰ªæ¡†å†…</li>
                <li><strong>è°ƒæ•´ä½ç½®å’Œå¤§å°</strong>ï¼šåœ¨å³ä¾§é¢„è§ˆåŒºåŸŸï¼Œä½ å¯ä»¥ï¼š
                    <ul style="margin-top: 0.5rem;">
                        <li>ç›´æ¥æ‹–åŠ¨äºŒç»´ç è°ƒæ•´ä½ç½®</li>
                        <li>ä½¿ç”¨"äºŒç»´ç å¤§å°"æ»‘å—è°ƒæ•´å°ºå¯¸ï¼ˆ0.6å€åˆ°1.6å€ï¼‰</li>
                        <li>ä½¿ç”¨"æ—‹è½¬è§’åº¦"æ»‘å—è°ƒæ•´æ—‹è½¬ï¼ˆ-180åº¦åˆ°180åº¦ï¼‰</li>
                        <li>ç‚¹å‡»"é€‚é…æ¨èåŒºåŸŸ"è‡ªåŠ¨è°ƒæ•´åˆ°æœ€ä½³ä½ç½®</li>
                    </ul>
                </li>
                <li><strong>ä¸‹è½½å›¾ç‰‡</strong>ï¼šè°ƒæ•´æ»¡æ„åï¼Œç‚¹å‡»"ä¸‹è½½å›¾ç‰‡"æŒ‰é’®ï¼Œä¿å­˜åˆæˆåçš„é«˜æ¸… PNG å›¾ç‰‡åˆ°ä½ çš„è®¾å¤‡</li>
            </ol>
            
            <p><strong>éšç§è¯´æ˜</strong>ï¼šæ‰€æœ‰å›¾ç‰‡å¤„ç†éƒ½åœ¨ä½ çš„æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå®Œå…¨ä¿æŠ¤ä½ çš„éšç§å®‰å…¨ã€‚</p>
        </section>

        <main class="tool-main">
            <section class="top-section">
                <div class="top-card">
                    <h2>æ¨¡æ¿é¢„è§ˆ</h2>
                    <div class="template-preview">
                        <img id="template-preview" alt="é—®å·äºŒç»´ç æ¢—å›¾æ¨¡æ¿é¢„è§ˆ - é€‰æ‹©ä¸åŒæ¨¡æ¿æŸ¥çœ‹æ•ˆæœ">
                    </div>
                    <div class="field">
                        <label>ä¸Šä¼ äºŒç»´ç å›¾ç‰‡</label>
                        <div class="input-file">
                            <label class="btn btn-secondary file-label" for="qr-input">
                                é€‰æ‹©å›¾ç‰‡
                            </label>
                            <input id="qr-input" type="file" accept="image/*">
                            <span class="file-name" id="file-name">å°šæœªé€‰æ‹©æ–‡ä»¶</span>
                        </div>
                    </div>
                </div>

                <div class="top-card">
                    <h2>ç”Ÿæˆé¢„è§ˆ</h2>
                    <div class="preview-wrapper">
                        <div class="preview-box">
                            <div class="preview-box-inner">
                                <div class="preview-placeholder" id="preview-placeholder">
                                    é€‰æ‹©æ¨¡æ¿å¹¶ä¸Šä¼ äºŒç»´ç åï¼Œå³ä¾§æ˜¾ç¤ºåˆæˆé¢„è§ˆã€‚
                                </div>
                                <canvas id="editor-canvas" class="editor-canvas" style="display:none;"></canvas>
                                <canvas id="editor-overlay" class="editor-overlay" style="display:none;"></canvas>
                            </div>
                        </div>

                        <div class="editor-controls">
                            <div class="range-control">
                                <label for="scale-range">äºŒç»´ç å¤§å°</label>
                                <input id="scale-range" type="range" min="0.6" max="1.6" step="0.01" value="1">
                            </div>
                            <div class="range-control">
                                <label for="rotate-range">æ—‹è½¬è§’åº¦</label>
                                <input id="rotate-range" type="range" min="-180" max="180" step="1" value="0">
                            </div>
                            <div class="editor-actions">
                                <button class="btn btn-secondary" id="fit-btn">é€‚é…æ¨èåŒºåŸŸ</button>
                                <button class="btn btn-secondary" id="reset-btn">é‡ç½®ä½ç½®</button>
                                <button class="btn btn-secondary" id="recrop-btn" disabled>é‡æ–°è£å‰ª</button>
                                <!-- <button class="btn btn-secondary" id="debug-btn" disabled>è¾“å‡ºå½“å‰å‚æ•°</button> -->
                                <button class="btn btn-secondary" id="download-btn" disabled>ä¸‹è½½å›¾ç‰‡</button>
                            </div>
                            <div class="editor-hint" id="editor-hint">æ‹–åŠ¨äºŒç»´ç è°ƒæ•´ä½ç½®ï¼Œæ»‘å—ç¼©æ”¾å¤§å°ã€‚</div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="panel">
                <h2>æ¨¡æ¿å¹¿åœº</h2>
                <div class="templates-search">
                    <div class="search-box">
                        <span>ğŸ”</span>
                        <input id="template-search" type="text" placeholder="æœç´¢æ¨¡æ¿">
                    </div>
                </div>
                <div class="templates-toolbar" style="display:none;">
                    <div class="filter-row">
                        <div class="filter-chips" id="filter-chips"></div>
                        <div class="template-count" id="template-count"></div>
                    </div>
                </div>
                <div class="templates-grid" id="templates-grid">
                    <!-- æ¨¡æ¿å¡ç‰‡ç”±è„šæœ¬æ¸²æŸ“ -->
                </div>
                <div class="templates-empty" id="templates-empty" style="display:none;">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ¨¡æ¿ã€‚</div>
                <div class="template-hint" id="template-hint">è¯·é€‰æ‹©æ¨¡æ¿ï¼Œç³»ç»Ÿä¼šæç¤ºé€‚åˆçš„äºŒç»´ç å°ºå¯¸ã€‚</div>
            </section>

            <section class="faq-section">
                <h2>å¸¸è§é—®é¢˜</h2>
                <div class="faq-item">
                    <div class="faq-question">æ”¯æŒå“ªäº›é—®å·å¹³å°ï¼Ÿ</div>
                    <p class="faq-answer">æ”¯æŒæ‰€æœ‰ç”ŸæˆäºŒç»´ç çš„é—®å·å¹³å°ï¼ŒåŒ…æ‹¬é—®å·æ˜Ÿã€è…¾è®¯é—®å·ã€Google Formsã€Microsoft Formsã€Typeform ç­‰ã€‚åªè¦ä½ èƒ½å¯¼å‡ºäºŒç»´ç å›¾ç‰‡ï¼Œå°±å¯ä»¥ä½¿ç”¨æœ¬å·¥å…·ã€‚</p>
                </div>
                <div class="faq-item">
                    <div class="faq-question">æ”¯æŒå“ªäº›å›¾ç‰‡æ ¼å¼ï¼Ÿ</div>
                    <p class="faq-answer">æ”¯æŒå¸¸è§çš„å›¾ç‰‡æ ¼å¼ï¼ŒåŒ…æ‹¬ PNGã€JPGã€JPEGã€WebP ç­‰ã€‚å»ºè®®ä½¿ç”¨ PNG æ ¼å¼ä»¥è·å¾—æœ€ä½³æ•ˆæœã€‚</p>
                </div>
                <div class="faq-item">
                    <div class="faq-question">å›¾ç‰‡ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨å—ï¼Ÿ</div>
                    <p class="faq-answer">ä¸ä¼šã€‚æ‰€æœ‰å›¾ç‰‡å¤„ç†éƒ½åœ¨ä½ çš„æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨ï¼Œå®Œå…¨ä¿æŠ¤ä½ çš„éšç§å®‰å…¨ã€‚</p>
                </div>
                <div class="faq-item">
                    <div class="faq-question">å¦‚ä½•è°ƒæ•´äºŒç»´ç çš„ä½ç½®å’Œå¤§å°ï¼Ÿ</div>
                    <p class="faq-answer">åœ¨é¢„è§ˆåŒºåŸŸå¯ä»¥ç›´æ¥æ‹–åŠ¨äºŒç»´ç è°ƒæ•´ä½ç½®ï¼Œä½¿ç”¨"äºŒç»´ç å¤§å°"æ»‘å—è°ƒæ•´å°ºå¯¸ï¼Œä½¿ç”¨"æ—‹è½¬è§’åº¦"æ»‘å—è°ƒæ•´æ—‹è½¬ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡»"é€‚é…æ¨èåŒºåŸŸ"æŒ‰é’®è‡ªåŠ¨è°ƒæ•´åˆ°æœ€ä½³ä½ç½®ã€‚</p>
                </div>
                <div class="faq-item">
                    <div class="faq-question">ä¸‹è½½çš„å›¾ç‰‡è´¨é‡å¦‚ä½•ï¼Ÿ</div>
                    <p class="faq-answer">ä¸‹è½½çš„å›¾ç‰‡ä¸º PNG æ ¼å¼ï¼Œä¿æŒåŸå§‹æ¨¡æ¿çš„é«˜æ¸…è´¨é‡ã€‚å»ºè®®äºŒç»´ç å°ºå¯¸è®¾ç½®ä¸º 600x600 åƒç´ æˆ–æ›´å¤§ï¼Œä»¥ç¡®ä¿æ‰«ææ•ˆæœã€‚</p>
                </div>
                <div class="faq-item">
                    <div class="faq-question">å¯ä»¥è‡ªå®šä¹‰æ¨¡æ¿å—ï¼Ÿ</div>
                    <p class="faq-answer">ç›®å‰æä¾› 34 ç§é¢„è®¾æ¨¡æ¿ã€‚å¦‚æœä½ éœ€è¦æ·»åŠ è‡ªå®šä¹‰æ¨¡æ¿ï¼Œå¯ä»¥å°†å›¾ç‰‡æ”¾åœ¨ `/public/tools/qr-meme-templates/` ç›®å½•ä¸‹ï¼Œå¹¶åœ¨é¡µé¢è„šæœ¬ä¸­æ·»åŠ å¯¹åº”é…ç½®ã€‚</p>
                </div>
                <div class="faq-item">
                    <div class="faq-question">å·¥å…·æ˜¯å…è´¹çš„å—ï¼Ÿ</div>
                    <p class="faq-answer">æ˜¯çš„ï¼Œå®Œå…¨å…è´¹ä½¿ç”¨ï¼Œæ— éœ€æ³¨å†Œï¼Œæ— éœ€ä»˜è´¹ï¼Œæ²¡æœ‰ä»»ä½•é™åˆ¶ã€‚</p>
                </div>
                <div class="faq-item">
                    <div class="faq-question">åœ¨æ‰‹æœºä¸Šå¯ä»¥ä½¿ç”¨å—ï¼Ÿ</div>
                    <p class="faq-answer">å¯ä»¥ã€‚æœ¬å·¥å…·æ”¯æŒç§»åŠ¨ç«¯æµè§ˆå™¨ï¼Œåœ¨æ‰‹æœºã€å¹³æ¿ç­‰è®¾å¤‡ä¸Šéƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p>
                </div>
            </section>

            <section class="related-tools-section">
                <h2>ç›¸å…³å·¥å…·</h2>
                <ul class="related-tools-list">
                    <li><a href="/tools/qr-generator.html">äºŒç»´ç ç”Ÿæˆå™¨</a> - å¿«é€Ÿç”Ÿæˆå„ç§äºŒç»´ç </li>
                    <li><a href="/zh/tools/">æ›´å¤šåœ¨çº¿å·¥å…·</a> - æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å·¥å…·</li>
                </ul>
            </section>
        </main>

        <canvas id="work-canvas" style="display:none;"></canvas>
    </div>

    <div class="modal" id="crop-modal" aria-hidden="true">
        <div class="modal-card">
            <h3>è£å‰ªäºŒç»´ç å›¾ç‰‡</h3>
            <div class="crop-stage">
                <canvas id="crop-canvas" class="crop-canvas" width="480" height="480"></canvas>
                <div class="crop-meta">
                    <span id="crop-hint">æ‹–åŠ¨ä½ç½®ï¼Œç”¨æ»‘åŠ¨æ¡è‡ªç”±å¾®è°ƒæ”¾å¤§</span>
                    <span>æ¨èå°ºå¯¸ï¼š<strong id="crop-size">600 x 600</strong></span>
                </div>
                <input id="crop-zoom" type="range" min="1" max="3" step="0.01" value="1" style="width:100%;">
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="crop-cancel">å–æ¶ˆ</button>
                <button class="btn btn-primary" id="crop-confirm">ç¡®å®šè£å‰ª</button>
            </div>
        </div>
    </div>

    <script>
        (function () {
            /**
             * æ¨¡æ¿é…ç½®ï¼š
             * - id: å”¯ä¸€æ ‡è¯†
             * - name: å±•ç¤ºåç§°
             * - thumb: ç¼©ç•¥å›¾è·¯å¾„ï¼ˆå»ºè®®å°ºå¯¸è¾ƒå°ï¼‰
             * - image: åŸå§‹å¤§å›¾è·¯å¾„ï¼ˆç”¨äºåˆæˆï¼‰
             * - qrRect: ä½¿ç”¨å½’ä¸€åŒ–åæ ‡çš„äºŒç»´ç åŒºåŸŸï¼Œå€¼èŒƒå›´ 0-1ï¼Œç›¸å¯¹äºæ•´å¼ å›¾ï¼š
             *   - x, y ä¸ºå·¦ä¸Šè§’åæ ‡ï¼ˆå æ•´å¼ å›¾å®½/é«˜çš„æ¯”ä¾‹ï¼‰
             *   - width, height ä¸ºå®½é«˜æ¯”ä¾‹
             * - recommendedSize: æ¨èäºŒç»´ç å°ºå¯¸ï¼ˆåƒç´ ï¼‰
             * - defaultRotation: é»˜è®¤æ—‹è½¬è§’åº¦ï¼ˆåº¦ï¼Œå¯é€‰ï¼ŒèŒƒå›´ -180 åˆ° 180ï¼‰
             */
            const templates = [
                {
                    id: 'queshi',
                    name: 'ç¼ºå¤±ä¸€å—',
                    thumb: './qr-meme-templates/001.png',
                    image: './qr-meme-templates/001.png',
                    // å³ä¾§ä¸­é—´åŒºåŸŸï¼Œå¤§è‡´è¦†ç›–ç¬”è®°æœ¬å±å¹•ï¼›æ ¹æ®éœ€è¦å¯ä»¥å†å¾®è°ƒè¿™å››ä¸ªæ¯”ä¾‹
                    qrRect: { x: 0.63, y: 0.29, width: 0.30, height: 0.30 },
                    recommendedSize: 600,
                    tags: ['åŠå…¬', 'é—®å·', 'ç®€æ´'],
                    desc: 'é€‚åˆæ—¥å¸¸åŠå…¬ç¾¤ã€ç­çº§ç¾¤ã€ç¤¾ç¾¤é€šçŸ¥ã€‚'
                },
                {
                    id: 'wangzi-gongzhu',
                    name: 'ç‹å­å…¬ä¸»è¯·å¡«é—®å·',
                    thumb: './qr-meme-templates/002.png',
                    image: './qr-meme-templates/002.png',
                    // å·¦ä¸‹è§’å¹³æ¿ä¸Šçš„äºŒç»´ç åŒºåŸŸï¼Œä½¿ç”¨ç•¥å¤§ä¸€äº›çš„æ¨èåŒºåŸŸï¼Œæ–¹ä¾¿åç»­æ‹–åŠ¨å¾®è°ƒ
                    qrRect: { x: 0.10, y: 0.55, width: 0.38, height: 0.35 },
                    recommendedSize: 600,
                    tags: ['åŠ¨æ¼«', 'é—®å·', 'å¯çˆ±'],
                    desc: 'æ–°ä¹‹åŠ©ä¸¾ç€å¹³æ¿ï¼Œè¯·ä½ å¸®å¿™å¡«é—®å·çš„ç»å…¸æ¢—å›¾ã€‚'
                },
                {
                    id: 'shouju',
                    name: 'ä¸¾æ‰‹ç¤ºæ„',
                    thumb: './qr-meme-templates/003.png',
                    image: './qr-meme-templates/003.png',
                    // äººç‰©æ‰‹ä¸Šçš„äºŒç»´ç åŒºåŸŸï¼Œä½ç½®å¯æ ¹æ®å®é™…å›¾ç‰‡å¾®è°ƒ
                    qrRect: { x: 0.33, y: 0.58, width: 0.28, height: 0.28 },
                    recommendedSize: 600,
                    tags: ['äººç‰©', 'é—®å·', 'æ‰‹åŠ¿'],
                    desc: 'äººç‰©ä¸¾æ‰‹ç¤ºæ„ï¼ŒäºŒç»´ç æ”¾åœ¨æ‰‹æŒä½ç½®ã€‚'
                },
                {
                    id: 'zhuozi',
                    name: 'æ¡Œå­ä¸Šçš„äºŒç»´ç ',
                    thumb: './qr-meme-templates/004.png',
                    image: './qr-meme-templates/004.png',
                    // æ¡Œå­ä¸Šçš„äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3351, y: 0.7954, width: 0.1437, height: 0.1437 },
                    recommendedSize: 600,
                    defaultRotation: -150,
                    tags: ['åŠå…¬', 'é—®å·', 'æ¡Œé¢'],
                    desc: 'äºŒç»´ç æ”¾åœ¨æ¡Œå­ä¸Šé¢ï¼Œé€‚åˆåŠå…¬åœºæ™¯ã€‚'
                },
                {
                    id: 'template-005',
                    name: 'æ¨¡æ¿005',
                    thumb: './qr-meme-templates/005.png',
                    image: './qr-meme-templates/005.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3679, y: 0.5727, width: 0.25, height: 0.25 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ–°æ¨¡æ¿ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-006',
                    name: 'æ¨¡æ¿006',
                    thumb: './qr-meme-templates/006.png',
                    image: './qr-meme-templates/006.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3729, y: 0.5169, width: 0.25, height: 0.186 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿006ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-007',
                    name: 'æ¨¡æ¿007',
                    thumb: './qr-meme-templates/007.png',
                    image: './qr-meme-templates/007.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3882, y: 0.5949, width: 0.25, height: 0.186 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿007ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-008',
                    name: 'æ¨¡æ¿008',
                    thumb: './qr-meme-templates/008.png',
                    image: './qr-meme-templates/008.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.7146, y: 0.4025, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿008ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-009',
                    name: 'æ¨¡æ¿009',
                    thumb: './qr-meme-templates/009.png',
                    image: './qr-meme-templates/009.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3899, y: 0.7066, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿009ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-010',
                    name: 'æ¨¡æ¿010',
                    thumb: './qr-meme-templates/010.png',
                    image: './qr-meme-templates/010.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3983, y: 0.7454, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿010ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-011',
                    name: 'æ¨¡æ¿011',
                    thumb: './qr-meme-templates/011.png',
                    image: './qr-meme-templates/011.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå¾…ç”¨æˆ·æä¾›å…·ä½“å‚æ•°åè°ƒæ•´
                    qrRect: { x: 0.40, y: 0.50, width: 0.25, height: 0.25 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ–°æ¨¡æ¿ï¼ŒäºŒç»´ç ä½ç½®å¾…é…ç½®ã€‚'
                },
                {
                    id: 'template-012',
                    name: 'æ¨¡æ¿012',
                    thumb: './qr-meme-templates/012.png',
                    image: './qr-meme-templates/012.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.378, y: 0.4698, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿012ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-013',
                    name: 'æ¨¡æ¿013',
                    thumb: './qr-meme-templates/013.png',
                    image: './qr-meme-templates/013.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3866, y: 0.5428, width: 0.3275, height: 0.1834 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿013ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-014',
                    name: 'æ¨¡æ¿014',
                    thumb: './qr-meme-templates/014.png',
                    image: './qr-meme-templates/014.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3664, y: 0.5646, width: 0.2836, height: 0.1588 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿014ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-015',
                    name: 'æ¨¡æ¿015',
                    thumb: './qr-meme-templates/015.png',
                    image: './qr-meme-templates/015.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.6313, y: 0.5737, width: 0.305, height: 0.1708 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿015ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-016',
                    name: 'æ¨¡æ¿016',
                    thumb: './qr-meme-templates/016.png',
                    image: './qr-meme-templates/016.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3832, y: 0.6791, width: 0.26, height: 0.1456 },
                    recommendedSize: 600,
                    defaultRotation: 6,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿016ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-017',
                    name: 'æ¨¡æ¿017',
                    thumb: './qr-meme-templates/017.png',
                    image: './qr-meme-templates/017.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.378, y: 0.6687, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿017ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-018',
                    name: 'æ¨¡æ¿018',
                    thumb: './qr-meme-templates/018.png',
                    image: './qr-meme-templates/018.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3915, y: 0.7662, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿018ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-019',
                    name: 'æ¨¡æ¿019',
                    thumb: './qr-meme-templates/019.png',
                    image: './qr-meme-templates/019.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3865, y: 0.627, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿019ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-020',
                    name: 'æ¨¡æ¿020',
                    thumb: './qr-meme-templates/020.png',
                    image: './qr-meme-templates/020.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3729, y: 0.572, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿020ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-021',
                    name: 'æ¨¡æ¿021',
                    thumb: './qr-meme-templates/021.png',
                    image: './qr-meme-templates/021.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.5708, y: 0.608, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿021ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-022',
                    name: 'æ¨¡æ¿022',
                    thumb: './qr-meme-templates/022.png',
                    image: './qr-meme-templates/022.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.6926, y: 0.8297, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿022ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-023',
                    name: 'æ¨¡æ¿023',
                    thumb: './qr-meme-templates/023.png',
                    image: './qr-meme-templates/023.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3865, y: 0.5683, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿023ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-024',
                    name: 'æ¨¡æ¿024',
                    thumb: './qr-meme-templates/024.png',
                    image: './qr-meme-templates/024.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.2275, y: 0.4309, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿024ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-025',
                    name: 'æ¨¡æ¿025',
                    thumb: './qr-meme-templates/025.png',
                    image: './qr-meme-templates/025.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3983, y: 0.7331, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    defaultRotation: -26,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿025ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-026',
                    name: 'æ¨¡æ¿026',
                    thumb: './qr-meme-templates/026.png',
                    image: './qr-meme-templates/026.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3797, y: 0.4679, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿026ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-027',
                    name: 'æ¨¡æ¿027',
                    thumb: './qr-meme-templates/027.png',
                    image: './qr-meme-templates/027.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3865, y: 0.3163, width: 0.25, height: 0.14 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿027ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-028',
                    name: 'æ¨¡æ¿028',
                    thumb: './qr-meme-templates/028.png',
                    image: './qr-meme-templates/028.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.3865, y: 0.4633, width: 0.25, height: 0.1407 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿028ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-029',
                    name: 'æ¨¡æ¿029',
                    thumb: './qr-meme-templates/029.png',
                    image: './qr-meme-templates/029.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.4085, y: 0.7355, width: 0.25, height: 0.1407 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿029ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-030',
                    name: 'æ¨¡æ¿030',
                    thumb: './qr-meme-templates/030.png',
                    image: './qr-meme-templates/030.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.4169, y: 0.6194, width: 0.25, height: 0.1407 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿030ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-031',
                    name: 'æ¨¡æ¿031',
                    thumb: './qr-meme-templates/031.png',
                    image: './qr-meme-templates/031.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.6977, y: 0.7536, width: 0.25, height: 0.1407 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿031ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-032',
                    name: 'æ¨¡æ¿032',
                    thumb: './qr-meme-templates/032.png',
                    image: './qr-meme-templates/032.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.6808, y: 0.7888, width: 0.25, height: 0.1407 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿032ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-033',
                    name: 'æ¨¡æ¿033',
                    thumb: './qr-meme-templates/033.png',
                    image: './qr-meme-templates/033.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.674, y: 0.3758, width: 0.25, height: 0.1407 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿033ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                },
                {
                    id: 'template-034',
                    name: 'æ¨¡æ¿034',
                    thumb: './qr-meme-templates/034.png',
                    image: './qr-meme-templates/034.png',
                    // äºŒç»´ç åŒºåŸŸï¼Œå·²æ ¹æ®å®é™…è°ƒæ•´ä¼˜åŒ–
                    qrRect: { x: 0.7246, y: 0.1692, width: 0.25, height: 0.1407 },
                    recommendedSize: 600,
                    tags: ['é—®å·'],
                    desc: 'æ¨¡æ¿034ï¼ŒäºŒç»´ç ä½ç½®å·²æ ¹æ®ç¤ºä¾‹é»˜è®¤é…ç½®ã€‚'
                }
            ];

            const templatesGrid = document.getElementById('templates-grid');
            const templatePreview = document.getElementById('template-preview');
            const templateSearch = document.getElementById('template-search');
            const filterChips = document.getElementById('filter-chips');
            const templateCount = document.getElementById('template-count');
            const templatesEmpty = document.getElementById('templates-empty');
            const templateHint = document.getElementById('template-hint');
            const qrInput = document.getElementById('qr-input');
            const fileNameSpan = document.getElementById('file-name');
            const downloadBtn = document.getElementById('download-btn');
            const previewPlaceholder = document.getElementById('preview-placeholder');
            const editorCanvas = document.getElementById('editor-canvas');
            const editorOverlay = document.getElementById('editor-overlay');
            const workCanvas = document.getElementById('work-canvas');
            const scaleRange = document.getElementById('scale-range');
            const rotateRange = document.getElementById('rotate-range');
            const fitBtn = document.getElementById('fit-btn');
            const resetBtn = document.getElementById('reset-btn');
            const recropBtn = document.getElementById('recrop-btn');
            const debugBtn = document.getElementById('debug-btn');
            const editorHint = document.getElementById('editor-hint');

            const cropModal = document.getElementById('crop-modal');
            const cropCanvas = document.getElementById('crop-canvas');
            const cropZoom = document.getElementById('crop-zoom');
            const cropConfirm = document.getElementById('crop-confirm');
            const cropCancel = document.getElementById('crop-cancel');
            const cropSizeLabel = document.getElementById('crop-size');

            let selectedTemplate = templates[7] || null;
            let qrFile = null;
            let qrSourceImage = null;
            let qrCroppedImage = null;
            let qrCroppedDataUrl = null;
            let resultDataUrl = null;
            const templateCache = new Map();
            let activeTag = 'å…¨éƒ¨';

            const editorState = {
                qrX: 0,
                qrY: 0,
                qrSize: 0,
                baseSize: 0,
                rotation: 0,
                dragging: false,
                resizing: false,
                dragOffsetX: 0,
                dragOffsetY: 0,
                anchorX: 0,
                anchorY: 0
            };

            const cropState = {
                img: null,
                baseScale: 1,
                scale: 1,
                zoom: 1,
                offsetX: 0,
                offsetY: 0,
                dragging: false,
                startX: 0,
                startY: 0,
                startOffsetX: 0,
                startOffsetY: 0,
                cropSize: 320
            };

            function clamp(value, min, max) {
                return Math.min(Math.max(value, min), max);
            }

            function getRecommendedSize(tpl) {
                return (tpl && tpl.recommendedSize) ? tpl.recommendedSize : 600;
            }

            function getAllTags() {
                const tags = new Set();
                templates.forEach((tpl) => {
                    (tpl.tags || []).forEach((tag) => tags.add(tag));
                });
                return ['å…¨éƒ¨', ...Array.from(tags)];
            }

            function getSearchValue() {
                return (templateSearch && templateSearch.value || '').trim().toLowerCase();
            }

            function getFilteredTemplates() {
                const query = getSearchValue();
                return templates.filter((tpl) => {
                    const tags = tpl.tags || [];
                    const matchesTag = activeTag === 'å…¨éƒ¨' || tags.includes(activeTag);
                    const matchesQuery = !query || tpl.name.toLowerCase().includes(query) ||
                        (tpl.desc || '').toLowerCase().includes(query) ||
                        tags.join(' ').toLowerCase().includes(query);
                    return matchesTag && matchesQuery;
                });
            }

            function updateTemplateHint() {
                if (!templateHint) return;
                if (!selectedTemplate) {
                    templateHint.textContent = 'è¯·é€‰æ‹©æ¨¡æ¿ï¼Œç³»ç»Ÿä¼šæç¤ºé€‚åˆçš„äºŒç»´ç å°ºå¯¸ã€‚';
                    return;
                }
                const size = getRecommendedSize(selectedTemplate);
                templateHint.innerHTML = 'æ¨èäºŒç»´ç å°ºå¯¸ï¼š<strong>' + size + ' x ' + size + ' px</strong>ï¼Œè¯·ä½¿ç”¨æ¸…æ™°çš„æ­£æ–¹å½¢å›¾ç‰‡ï¼Œå¯æ›´å¥½ä¸æ¢—å›¾åŒºåŸŸåŒ¹é…ã€‚';
                if (cropSizeLabel) {
                    cropSizeLabel.textContent = size + ' x ' + size;
                }
            }

            function updateTemplatePreview() {
                if (!templatePreview || !selectedTemplate) return;
                // ä½¿ç”¨ loading="eager" å› ä¸ºè¿™æ˜¯ç”¨æˆ·ä¸»åŠ¨é€‰æ‹©çš„é¢„è§ˆï¼Œéœ€è¦ç«‹å³æ˜¾ç¤º
                if (!templatePreview.hasAttribute('loading')) {
                    templatePreview.loading = 'eager';
                }
                templatePreview.src = selectedTemplate.image;
                templatePreview.alt = selectedTemplate.name;
            }

            function renderFilterChips() {
                if (!filterChips) return;
                const tags = getAllTags();
                filterChips.innerHTML = '';
                tags.forEach((tag) => {
                    const chip = document.createElement('button');
                    chip.type = 'button';
                    chip.className = 'filter-chip' + (tag === activeTag ? ' active' : '');
                    chip.textContent = tag;
                    chip.addEventListener('click', () => {
                        activeTag = tag;
                        renderFilterChips();
                        renderTemplates();
                    });
                    filterChips.appendChild(chip);
                });
            }

            function renderTemplates() {
                if (!templatesGrid) return;
                const filtered = getFilteredTemplates();
                templatesGrid.innerHTML = '';
                filtered.forEach((tpl) => {
                    const card = document.createElement('button');
                    card.type = 'button';
                    card.className = 'template-card' + (tpl.id === selectedTemplate?.id ? ' selected' : '');

                    const img = document.createElement('img');
                    img.className = 'template-thumb';
                    img.src = tpl.thumb;
                    // ç”Ÿæˆæ›´å…·æè¿°æ€§çš„ alt æ–‡æœ¬
                    const altText = tpl.desc 
                        ? `é—®å·äºŒç»´ç æ¢—å›¾æ¨¡æ¿ï¼š${tpl.name} - ${tpl.desc}`
                        : `é—®å·äºŒç»´ç æ¢—å›¾æ¨¡æ¿ï¼š${tpl.name}`;
                    img.alt = altText;
                    img.loading = 'lazy';

                    card.setAttribute('aria-label', tpl.name);
                    card.setAttribute('title', tpl.name);

                    card.appendChild(img);

                    card.addEventListener('click', () => {
                        selectedTemplate = tpl;
                        Array.from(templatesGrid.children).forEach((el) => {
                            el.classList.remove('selected');
                        });
                        card.classList.add('selected');
                        updateTemplateHint();
                        updateTemplatePreview();
                        if (qrCroppedImage) {
                            setupEditor(true);
                        }
                    });

                    templatesGrid.appendChild(card);
                });
                if (templatesEmpty) {
                    templatesEmpty.style.display = filtered.length ? 'none' : 'block';
                }
                if (templateCount) {
                    templateCount.textContent = filtered.length + ' / ' + templates.length + ' ä¸ªæ¨¡æ¿';
                }
                if (filtered.length && (!selectedTemplate || !filtered.some((tpl) => tpl.id === selectedTemplate.id))) {
                    selectedTemplate = filtered[0];
                    updateTemplateHint();
                    updateTemplatePreview();
                }
            }

            function updateDownloadButtonState() {
                downloadBtn.disabled = !resultDataUrl;
            }

            function updateDebugButtonState() {
                if (!debugBtn) return;
                debugBtn.disabled = !selectedTemplate || !qrCroppedImage || !editorCanvas || !editorCanvas.width || !editorCanvas.height;
            }

            function setEditorVisibility(visible) {
                if (previewPlaceholder) {
                    previewPlaceholder.style.display = visible ? 'none' : 'block';
                }
                if (editorCanvas) {
                    editorCanvas.style.display = visible ? 'block' : 'none';
                }
                if (editorOverlay) {
                    editorOverlay.style.display = visible ? 'block' : 'none';
                }
            }

            function loadImage(src) {
                return new Promise(function (resolve, reject) {
                    const img = new Image();
                    img.crossOrigin = 'anonymous';
                    img.onload = function () {
                        resolve(img);
                    };
                    img.onerror = function () {
                        reject(new Error('å›¾ç‰‡åŠ è½½å¤±è´¥ï¼š' + src));
                    };
                    img.src = src;
                });
            }

            function loadImageFromFile(file) {
                return new Promise(function (resolve, reject) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const img = new Image();
                        img.onload = function () {
                            resolve(img);
                        };
                        img.onerror = function () {
                            reject(new Error('æ— æ³•åŠ è½½ä¸Šä¼ çš„å›¾ç‰‡'));
                        };
                        img.src = e.target.result;
                    };
                    reader.onerror = function () {
                        reject(new Error('è¯»å–æ–‡ä»¶å¤±è´¥'));
                    };
                    reader.readAsDataURL(file);
                });
            }

            async function getTemplateImage() {
                if (!selectedTemplate) return null;
                if (templateCache.has(selectedTemplate.id)) {
                    return templateCache.get(selectedTemplate.id);
                }
                const img = await loadImage(selectedTemplate.image);
                templateCache.set(selectedTemplate.id, img);
                return img;
            }

            function openCropModal(img) {
                cropState.img = img;
                cropState.zoom = 1;
                cropState.offsetX = 0;
                cropState.offsetY = 0;
                const canvasSize = cropCanvas.width;
                cropState.cropSize = Math.round(canvasSize * 0.7);
                const minScale = Math.max(
                    cropState.cropSize / img.width,
                    cropState.cropSize / img.height
                );
                cropState.baseScale = minScale;
                cropState.scale = minScale;
                cropZoom.value = 1;
                constrainCrop();
                drawCropCanvas();
                cropModal.classList.add('is-open');
                cropModal.setAttribute('aria-hidden', 'false');
            }

            function closeCropModal() {
                cropModal.classList.remove('is-open');
                cropModal.setAttribute('aria-hidden', 'true');
            }

            function constrainCrop() {
                if (!cropState.img) return;
                const canvasSize = cropCanvas.width;
                const cropSize = cropState.cropSize;
                const cropX = (canvasSize - cropSize) / 2;
                const cropY = (canvasSize - cropSize) / 2;
                const imgW = cropState.img.width * cropState.scale;
                const imgH = cropState.img.height * cropState.scale;
                const baseX = (canvasSize - imgW) / 2;
                const baseY = (canvasSize - imgH) / 2;
                const minOffsetX = cropX + cropSize - imgW - baseX;
                const maxOffsetX = cropX - baseX;
                const minOffsetY = cropY + cropSize - imgH - baseY;
                const maxOffsetY = cropY - baseY;
                cropState.offsetX = clamp(cropState.offsetX, minOffsetX, maxOffsetX);
                cropState.offsetY = clamp(cropState.offsetY, minOffsetY, maxOffsetY);
            }

            function drawCropCanvas() {
                if (!cropState.img) return;
                const ctx = cropCanvas.getContext('2d');
                const canvasSize = cropCanvas.width;
                const cropSize = cropState.cropSize;
                const cropX = (canvasSize - cropSize) / 2;
                const cropY = (canvasSize - cropSize) / 2;
                const imgW = cropState.img.width * cropState.scale;
                const imgH = cropState.img.height * cropState.scale;
                const imgX = (canvasSize - imgW) / 2 + cropState.offsetX;
                const imgY = (canvasSize - imgH) / 2 + cropState.offsetY;

                ctx.clearRect(0, 0, canvasSize, canvasSize);
                ctx.drawImage(cropState.img, imgX, imgY, imgW, imgH);

                ctx.save();
                ctx.fillStyle = 'rgba(15,23,42,0.45)';
                ctx.fillRect(0, 0, canvasSize, canvasSize);
                ctx.globalCompositeOperation = 'destination-out';
                ctx.fillRect(cropX, cropY, cropSize, cropSize);
                ctx.restore();

                ctx.save();
                ctx.strokeStyle = 'rgba(255,255,255,0.9)';
                ctx.lineWidth = 2;
                ctx.strokeRect(cropX, cropY, cropSize, cropSize);
                ctx.restore();
            }

            function confirmCrop() {
                if (!cropState.img) return;
                const canvasSize = cropCanvas.width;
                const cropSize = cropState.cropSize;
                const cropX = (canvasSize - cropSize) / 2;
                const cropY = (canvasSize - cropSize) / 2;
                const imgW = cropState.img.width * cropState.scale;
                const imgH = cropState.img.height * cropState.scale;
                const imgX = (canvasSize - imgW) / 2 + cropState.offsetX;
                const imgY = (canvasSize - imgH) / 2 + cropState.offsetY;

                const sx = clamp((cropX - imgX) / imgW * cropState.img.width, 0, cropState.img.width);
                const sy = clamp((cropY - imgY) / imgH * cropState.img.height, 0, cropState.img.height);
                const sWidth = clamp(cropSize / imgW * cropState.img.width, 1, cropState.img.width);
                const sHeight = clamp(cropSize / imgH * cropState.img.height, 1, cropState.img.height);

                const outputSize = getRecommendedSize(selectedTemplate);
                const output = document.createElement('canvas');
                output.width = outputSize;
                output.height = outputSize;
                const outCtx = output.getContext('2d');
                outCtx.imageSmoothingEnabled = false;
                outCtx.drawImage(cropState.img, sx, sy, sWidth, sHeight, 0, 0, outputSize, outputSize);

                qrCroppedDataUrl = output.toDataURL('image/png');
                const img = new Image();
                img.onload = function () {
                    qrCroppedImage = img;
                    setupEditor(true);
                    closeCropModal();
                    recropBtn.disabled = false;
                };
                img.src = qrCroppedDataUrl;
            }

            async function setupEditor(resetPosition) {
                if (!selectedTemplate || !qrCroppedImage) {
                    setEditorVisibility(false);
                    return;
                }
                const templateImg = await getTemplateImage();
                if (!templateImg) return;
                editorCanvas.width = templateImg.width;
                editorCanvas.height = templateImg.height;
                editorOverlay.width = templateImg.width;
                editorOverlay.height = templateImg.height;
                if (resetPosition || !editorState.qrSize) {
                    const { x, y, width, height } = selectedTemplate.qrRect;
                    const rectW = width * editorCanvas.width;
                    const rectH = height * editorCanvas.height;
                    const size = Math.min(rectW, rectH);
                    editorState.qrSize = size;
                    editorState.baseSize = size;
                    // åº”ç”¨é»˜è®¤æ—‹è½¬è§’åº¦ï¼ˆå¦‚æœæ¨¡æ¿æœ‰é…ç½®ï¼‰
                    const defaultRotation = selectedTemplate.defaultRotation !== undefined ? selectedTemplate.defaultRotation : 0;
                    editorState.rotation = defaultRotation;
                    editorState.qrX = x * editorCanvas.width + (rectW - size) / 2;
                    editorState.qrY = y * editorCanvas.height + (rectH - size) / 2;
                    scaleRange.value = '1';
                    if (rotateRange) {
                        rotateRange.value = String(defaultRotation);
                    }
                }
                setEditorVisibility(true);
                renderEditor();
            }

            async function renderEditor() {
                const templateImg = await getTemplateImage();
                if (!templateImg || !qrCroppedImage) return;
                const ctx = editorCanvas.getContext('2d');
                const overlayCtx = editorOverlay.getContext('2d');
                ctx.clearRect(0, 0, editorCanvas.width, editorCanvas.height);
                ctx.drawImage(templateImg, 0, 0);
                ctx.save();
                ctx.imageSmoothingEnabled = false;
                const centerX = editorState.qrX + editorState.qrSize / 2;
                const centerY = editorState.qrY + editorState.qrSize / 2;
                const radians = (editorState.rotation || 0) * Math.PI / 180;
                ctx.translate(centerX, centerY);
                ctx.rotate(radians);
                ctx.drawImage(
                    qrCroppedImage,
                    -editorState.qrSize / 2,
                    -editorState.qrSize / 2,
                    editorState.qrSize,
                    editorState.qrSize
                );
                ctx.restore();

                overlayCtx.clearRect(0, 0, editorOverlay.width, editorOverlay.height);
                drawEditorHandles(overlayCtx);

                resultDataUrl = editorCanvas.toDataURL('image/png');
                updateDownloadButtonState();
                updateDebugButtonState();
            }

            function drawEditorHandles(ctx) {
                const size = editorState.qrSize;
                const x = editorState.qrX;
                const y = editorState.qrY;
                ctx.save();
                ctx.strokeStyle = 'rgba(15,23,42,0.55)';
                ctx.lineWidth = 2;
                ctx.strokeRect(x, y, size, size);
                const handleSize = 8;
                const handles = [
                    [x, y],
                    [x + size, y],
                    [x, y + size],
                    [x + size, y + size]
                ];
                ctx.fillStyle = 'rgba(255,255,255,0.95)';
                ctx.strokeStyle = 'rgba(15,23,42,0.8)';
                handles.forEach((pt) => {
                    ctx.beginPath();
                    ctx.arc(pt[0], pt[1], handleSize, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.stroke();
                });
                ctx.restore();
            }

            function clampQr() {
                const maxX = editorCanvas.width - editorState.qrSize;
                const maxY = editorCanvas.height - editorState.qrSize;
                editorState.qrX = clamp(editorState.qrX, 0, maxX);
                editorState.qrY = clamp(editorState.qrY, 0, maxY);
            }

            function handleEditorPointerDown(event) {
                if (!qrCroppedImage) return;
                const rect = editorCanvas.getBoundingClientRect();
                const scaleX = editorCanvas.width / rect.width;
                const scaleY = editorCanvas.height / rect.height;
                const x = (event.clientX - rect.left) * scaleX;
                const y = (event.clientY - rect.top) * scaleY;
                const handleSize = 14;

                const corners = [
                    { x: editorState.qrX, y: editorState.qrY, anchorX: editorState.qrX + editorState.qrSize, anchorY: editorState.qrY + editorState.qrSize },
                    { x: editorState.qrX + editorState.qrSize, y: editorState.qrY, anchorX: editorState.qrX, anchorY: editorState.qrY + editorState.qrSize },
                    { x: editorState.qrX, y: editorState.qrY + editorState.qrSize, anchorX: editorState.qrX + editorState.qrSize, anchorY: editorState.qrY },
                    { x: editorState.qrX + editorState.qrSize, y: editorState.qrY + editorState.qrSize, anchorX: editorState.qrX, anchorY: editorState.qrY }
                ];

                const hitCorner = corners.find((corner) => {
                    return Math.hypot(x - corner.x, y - corner.y) <= handleSize;
                });

                if (hitCorner) {
                    editorState.resizing = true;
                    editorState.dragging = false;
                    editorState.anchorX = hitCorner.anchorX;
                    editorState.anchorY = hitCorner.anchorY;
                    editorCanvas.setPointerCapture(event.pointerId);
                    return;
                }

                const inside = x >= editorState.qrX &&
                    x <= editorState.qrX + editorState.qrSize &&
                    y >= editorState.qrY &&
                    y <= editorState.qrY + editorState.qrSize;

                if (inside) {
                    editorState.dragging = true;
                    editorState.resizing = false;
                    editorState.dragOffsetX = x - editorState.qrX;
                    editorState.dragOffsetY = y - editorState.qrY;
                    editorCanvas.setPointerCapture(event.pointerId);
                }
            }

            function handleEditorPointerMove(event) {
                if (!editorState.dragging && !editorState.resizing) return;
                const rect = editorCanvas.getBoundingClientRect();
                const scaleX = editorCanvas.width / rect.width;
                const scaleY = editorCanvas.height / rect.height;
                const x = (event.clientX - rect.left) * scaleX;
                const y = (event.clientY - rect.top) * scaleY;
                if (editorState.dragging) {
                    editorState.qrX = x - editorState.dragOffsetX;
                    editorState.qrY = y - editorState.dragOffsetY;
                    clampQr();
                } else if (editorState.resizing) {
                    const newSize = Math.max(
                        Math.abs(x - editorState.anchorX),
                        Math.abs(y - editorState.anchorY)
                    );
                    const minSize = Math.min(editorCanvas.width, editorCanvas.height) * 0.08;
                    const size = clamp(newSize, minSize, Math.min(editorCanvas.width, editorCanvas.height));
                    editorState.qrSize = size;
                    editorState.qrX = editorState.anchorX - size;
                    editorState.qrY = editorState.anchorY - size;
                    clampQr();
                }
                if (editorState.baseSize) {
                    scaleRange.value = (editorState.qrSize / editorState.baseSize).toFixed(2);
                }
                renderEditor();
            }

            function handleEditorPointerUp(event) {
                if (editorState.dragging || editorState.resizing) {
                    editorState.dragging = false;
                    editorState.resizing = false;
                    editorCanvas.releasePointerCapture(event.pointerId);
                }
            }

            function fitToTemplate() {
                setupEditor(true);
            }

            function resetPosition() {
                setupEditor(true);
            }

            function handleScaleChange() {
                if (!editorState.baseSize) return;
                const ratio = Number(scaleRange.value);
                const centerX = editorState.qrX + editorState.qrSize / 2;
                const centerY = editorState.qrY + editorState.qrSize / 2;
                editorState.qrSize = editorState.baseSize * ratio;
                editorState.qrX = centerX - editorState.qrSize / 2;
                editorState.qrY = centerY - editorState.qrSize / 2;
                clampQr();
                renderEditor();
            }

            function handleRotateChange() {
                editorState.rotation = Number(rotateRange.value);
                renderEditor();
            }

            function handleDebugPrint() {
                if (!selectedTemplate || !qrCroppedImage) return;
                if (!editorCanvas || !editorCanvas.width || !editorCanvas.height) return;

                const tplW = editorCanvas.width;
                const tplH = editorCanvas.height;
                const normX = editorState.qrX / tplW;
                const normY = editorState.qrY / tplH;
                const normSizeW = editorState.qrSize / tplW;
                const normSizeH = editorState.qrSize / tplH;

                const payload = {
                    templateId: selectedTemplate.id,
                    templateName: selectedTemplate.name,
                    templateSize: { width: tplW, height: tplH },
                    defaultQrRect: selectedTemplate.qrRect,
                    defaultRotation: selectedTemplate.defaultRotation !== undefined ? selectedTemplate.defaultRotation : null,
                    editor: {
                        qrX: Number(editorState.qrX.toFixed(2)),
                        qrY: Number(editorState.qrY.toFixed(2)),
                        qrSize: Number(editorState.qrSize.toFixed(2)),
                        rotationDeg: Number((editorState.rotation || 0).toFixed(2))
                    },
                    normalized: {
                        x: Number(normX.toFixed(4)),
                        y: Number(normY.toFixed(4)),
                        width: Number(normSizeW.toFixed(4)),
                        height: Number(normSizeH.toFixed(4))
                    }
                };

                console.log('[qr-meme-maker] current placement:', payload);
                console.log('[qr-meme-maker] copy/paste JSON:', JSON.stringify(payload));
            }

            function handleDownload() {
                if (!resultDataUrl) return;
                const a = document.createElement('a');
                const date = new Date();
                const ts = date.toISOString().replace(/[:T]/g, '-').split('.')[0];
                a.href = resultDataUrl;
                a.download = 'qr-meme-' + ts + '.png';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }

            qrInput.addEventListener('change', async function (event) {
                const file = event.target.files && event.target.files[0];
                if (!file) {
                    qrFile = null;
                    qrSourceImage = null;
                    qrCroppedImage = null;
                    qrCroppedDataUrl = null;
                    fileNameSpan.textContent = 'å°šæœªé€‰æ‹©æ–‡ä»¶';
                    setEditorVisibility(false);
                    return;
                }
                qrFile = file;
                fileNameSpan.textContent = file.name;
                try {
                    const img = await loadImageFromFile(file);
                    qrSourceImage = img;
                    openCropModal(img);
                } catch (err) {
                    alert(err && err.message ? err.message : 'æ— æ³•åŠ è½½äºŒç»´ç å›¾ç‰‡');
                }
            });

            cropZoom.addEventListener('input', function () {
                cropState.zoom = Number(cropZoom.value);
                cropState.scale = cropState.baseScale * cropState.zoom;
                constrainCrop();
                drawCropCanvas();
            });

            cropCanvas.addEventListener('pointerdown', function (event) {
                if (!cropState.img) return;
                cropState.dragging = true;
                cropState.startX = event.clientX;
                cropState.startY = event.clientY;
                cropState.startOffsetX = cropState.offsetX;
                cropState.startOffsetY = cropState.offsetY;
                cropCanvas.setPointerCapture(event.pointerId);
            });

            cropCanvas.addEventListener('pointermove', function (event) {
                if (!cropState.dragging) return;
                cropState.offsetX = cropState.startOffsetX + (event.clientX - cropState.startX);
                cropState.offsetY = cropState.startOffsetY + (event.clientY - cropState.startY);
                constrainCrop();
                drawCropCanvas();
            });

            cropCanvas.addEventListener('pointerup', function (event) {
                cropState.dragging = false;
                cropCanvas.releasePointerCapture(event.pointerId);
            });

            cropCanvas.addEventListener('pointercancel', function () {
                cropState.dragging = false;
            });

            cropConfirm.addEventListener('click', function () {
                confirmCrop();
            });

            cropCancel.addEventListener('click', function () {
                closeCropModal();
            });

            downloadBtn.addEventListener('click', function () {
                handleDownload();
            });

            scaleRange.addEventListener('input', function () {
                handleScaleChange();
            });

            rotateRange.addEventListener('input', function () {
                handleRotateChange();
            });

            fitBtn.addEventListener('click', function () {
                fitToTemplate();
            });

            resetBtn.addEventListener('click', function () {
                resetPosition();
            });

            recropBtn.addEventListener('click', function () {
                if (qrSourceImage) {
                    openCropModal(qrSourceImage);
                }
            });

            if (debugBtn) {
                debugBtn.addEventListener('click', function () {
                    handleDebugPrint();
                });
            }

            editorCanvas.addEventListener('pointerdown', handleEditorPointerDown);
            editorCanvas.addEventListener('pointermove', handleEditorPointerMove);
            editorCanvas.addEventListener('pointerup', handleEditorPointerUp);
            editorCanvas.addEventListener('pointercancel', handleEditorPointerUp);

            if (templateSearch) {
                templateSearch.addEventListener('input', function () {
                    renderTemplates();
                });
            }

            renderFilterChips();
            renderTemplates();
            updateTemplateHint();
            updateTemplatePreview();
            updateDownloadButtonState();
            updateDebugButtonState();
            editorHint.textContent = 'æ‹–åŠ¨äºŒç»´ç è°ƒæ•´ä½ç½®ï¼Œæ»‘å—ç¼©æ”¾æˆ–æ—‹è½¬ã€‚';
        })();
    </script>
</body>
</html>

